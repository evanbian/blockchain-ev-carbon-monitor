# 前端设计文档

## 1. 概述

本文档描述了基于区块链的新能源车辆碳减排计量系统的前端设计。前端分为三个主要平台：管理平台、分析平台和展示平台，主要用于展厅环境展示，适配MacBook Pro 14" M1显示器，提供全面的自助式体验。

## 2. 技术栈选择

### 2.1 核心框架

- **React 18**: 组件化开发，虚拟DOM提高性能
- **TypeScript 5**: 强类型支持，提高代码质量和可维护性
- **Vite**: 快速的开发和构建工具

### 2.2 UI组件库

- **Ant Design 5.0**: 专业后台界面组件库
- **TailwindCSS 3.0**: 高度可定制的CSS框架
- **shadcn/ui**: 提供高质量的UI组件

### 2.3 数据可视化

- **ECharts 5.4**: 强大的图表库，适合数据分析场景
- **GSAP 3.11**: 专业的Web动画库
- **Three.js**: 3D可视化(可选)

### 2.4 状态管理

- **Redux Toolkit**: 复杂状态管理
- **React Query**: 数据获取和缓存
- **React Router 6**: 路由管理

### 2.5 区块链交互

- **Web3.js**: 与以太坊节点交互
- **ethers.js**: 轻量级区块链交互库

## 3. 前端架构

### 3.1 整体架构

```
┌─────────────────────────────────────────────────────────────┐
│                         应用入口                             │
│                      (App.tsx)                              │
└───────────────────────────┬─────────────────────────────────┘
                            │
            ┌───────────────┼───────────────┐
            │               │               │
┌───────────▼───────┐ ┌─────▼──────────┐ ┌──▼─────────────┐
│    管理平台        │ │    分析平台     │ │    展示平台     │
│  (Admin.tsx)      │ │  (Analysis.tsx)│ │  (Display.tsx) │
└───────────────────┘ └────────────────┘ └────────────────┘
```

### 3.2 模块划分

#### 3.2.1 核心模块

- **布局模块**: 页面整体布局和导航
- **身份验证**: 登录和权限控制
- **API封装**: 后端接口调用封装
- **全局状态**: 跨组件状态管理
- **工具函数**: 通用功能函数

#### 3.2.2 功能模块

- **车辆管理**: 车辆信息管理相关组件
- **数据可视化**: 图表和动效组件
- **区块链交互**: 区块链数据展示组件
- **系统配置**: 系统参数设置组件
- **数据导入/导出**: 数据处理相关组件

### 3.3 数据流

```
┌──────────────┐    ┌───────────────┐    ┌────────────────┐
│              │    │               │    │                │
│   API 层     ├───►│  Redux Store  ├───►│  React 组件    │
│              │    │               │    │                │
└──────────────┘    └───────────────┘    └────────────────┘
       ▲                                         │
       │                                         │
       └─────────────────────────────────────────┘
                       (Actions)
```

## 4. 界面设计

### 4.1 设计原则

- **一致性**: 统一的视觉语言和交互模式
- **简洁性**: 信息清晰直观，减少视觉干扰
- **响应性**: 适配目标设备分辨率，确保流畅体验
- **可用性**: 操作简单明了，减少学习成本
- **专业性**: 符合行业特点，突出科技和环保主题

### 4.2 色彩方案

```
主色系:
- 主要颜色: #1890ff (蓝色) - 代表科技感
- 次要颜色: #52c41a (绿色) - 代表环保主题

中性色:
- 背景色: #141414 (深色) / #f0f2f5 (浅色)
- 文本色: #ffffff (深色背景) / #000000 (浅色背景)
- 分割线: #303030 (深色) / #d9d9d9 (浅色)

功能色:
- 成功: #52c41a (绿色)
- 警告: #faad14 (黄色)
- 错误: #f5222d (红色)
- 信息: #1890ff (蓝色)

### 4.3 字体规范

- **主要字体**: 简体中文 - "PingFang SC", "Microsoft YaHei", sans-serif
- **代码字体**: "JetBrains Mono", "Fira Code", monospace
- **字号层级**:
  - 标题一级: 24px, 加粗
  - 标题二级: 20px, 加粗
  - 标题三级: 16px, 加粗
  - 正文大号: 16px, 常规
  - 正文标准: 14px, 常规
  - 辅助文本: 12px, 常规

### 4.4 布局规范

- **网格系统**: 24栅格系统
- **页面宽度**: 适配3024×1964像素分辨率
- **边距**:
  - 页面边距: 24px
  - 卡片内边距: 16px
  - 组件间距: 16px/24px
- **圆角**: 4px (小) / 8px (标准) / 16px (大)

## 5. 各平台设计

### 5.1 管理平台

#### 5.1.1 布局设计

```
┌──────────────────────────────────────────────────────────┐
│ Logo                                      用户信息  设置  │
├────────────┬─────────────────────────────────────────────┤
│            │                                             │
│            │                                             │
│   侧边导航   │                  内容区域                   │
│            │                                             │
│            │                                             │
└────────────┴─────────────────────────────────────────────┘
```

#### 5.1.2 主要页面

1. **车辆管理**
   - 车辆列表: 表格展示所有车辆信息
   - 车辆添加: 表单添加单个车辆
   - 批量导入: 上传CSV文件批量导入车辆

2. **系统配置**
   - 参数设置: 配置系统运行参数
   - 用户管理: 管理系统用户和权限

#### 5.1.3 交互设计

- **表格交互**:
  - 分页、排序、筛选
  - 行内编辑和行操作
  - 批量操作

- **表单交互**:
  - 实时验证
  - 分步表单
  - 自动保存

- **导入/导出**:
  - 拖放上传
  - 模板下载
  - 导入预览和确认

### 5.2 分析平台

#### 5.2.1 布局设计

```
┌──────────────────────────────────────────────────────────┐
│ Logo                       时间筛选       用户信息  设置  │
├────────────┬─────────────────────────────────────────────┤
│            │ ┌─────────┐ ┌─────────┐ ┌─────────┐         │
│            │ │ 卡片 1  │ │ 卡片 2  │ │ 卡片 3  │         │
│   侧边导航   │ └─────────┘ └─────────┘ └─────────┘         │
│            │ ┌───────────────────────────────────┐       │
│            │ │              图表区域             │       │
│            │ └───────────────────────────────────┘       │
└────────────┴─────────────────────────────────────────────┘
```

#### 5.2.2 主要页面

1. **碳减排总览**
   - 关键指标卡片
   - 碳减排趋势图
   - 减排效益对比

2. **车辆分析**
   - 车辆能耗分析
   - 行驶模式分析
   - 车型对比分析

3. **预测分析**
   - 减排趋势预测
   - 情景模拟
   - 潜力分析

4. **异常监控**
   - 实时告警
   - 告警历史
   - 异常分析

#### 5.2.3 图表设计

- **折线图**: 时间序列数据，如碳减排趋势
- **柱状图**: 分类数据对比，如不同车型减排量
- **饼图/环图**: 构成占比，如减排来源分布
- **散点图**: 相关性分析，如里程与减排量关系
- **热力图**: 时空分布，如车辆活动区域
- **雷达图**: 多维数据对比，如车辆性能评估

#### 5.2.4 交互设计

- **图表交互**:
  - 缩放、平移
  - 数据点悬停提示
  - 图例点击筛选
  - 下钻分析

- **筛选器**:
  - 时间范围选择
  - 车辆/车型筛选
  - 多条件组合筛选

- **导出功能**:
  - 图表导出为图片
  - 数据导出为CSV/Excel

### 5.3 展示平台

#### 5.3.1 布局设计

```
┌──────────────────────────────────────────────────────────┐
│                     碳积分总量计数器                      │
├──────────────────────────────────────────────────────────┤
│                                                          │
│                    车辆分布与动态展示                     │
│                                                          │
├────────────────────────┬─────────────────────────────────┤
│                        │                                 │
│     数据流向动效        │        区块链信息展示           │
│                        │                                 │
└────────────────────────┴─────────────────────────────────┘
```

#### 5.3.2 主要功能

1. **碳积分实时展示**
   - 大型数字计数器
   - 增量动画效果
   - 累计减排环境效益展示

2. **车辆动态展示**
   - 区域车辆分布热图
   - 车辆行驶轨迹动画
   - 实时能耗与减排可视化

3. **区块链浏览器**
   - 最新区块展示
   - 交易流动效果
   - 智能合约执行展示
   - 简化查询功能

#### 5.3.3 动效设计

- **数字滚动**: 使用GSAP实现平滑数字变化
- **粒子效果**: 表示碳积分生成
- **流动光效**: 表示数据上链过程
- **呼吸效果**: 指示系统活跃状态
- **闪光特效**: 新区块生成时的强调效果

#### 5.3.4 交互设计

- **触摸交互**:
  - 点击查看详细信息
  - 拖动旋转3D元素(如有)
  - 双指缩放地图

- **自动循环**:
  - 数据展示自动轮播
  - 场景自动切换
  - 定时刷新数据

## 6. 响应式设计

### 6.1 尺寸适配

- **主要目标**: MacBook Pro 14" (3024×1964像素)
- **其他可能设备**: 同比例的显示器或投影设备

### 6.2 适配策略

- **弹性布局**: 使用flex和grid实现自适应布局
- **相对单位**: 使用rem、em、vw、vh等相对单位
- **媒体查询**: 关键断点处调整布局
- **最小/最大宽度**: 确保在极端尺寸下仍保持可用性

## 7. 性能优化

### 7.1 代码优化

- **代码分割**: 按路由和组件分割代码
- **懒加载**: 非关键资源延迟加载
- **虚拟列表**: 处理长列表数据
- **缓存策略**: 使用React Query缓存API数据

### 7.2 资源优化

- **图片优化**: 使用WebP格式，合理压缩
- **字体优化**: 使用系统字体，减少自定义字体
- **按需加载**: 组件和图表库按需导入

### 7.3 渲染优化

- **减少重渲染**: 使用React.memo、useMemo、useCallback
- **避免布局抖动**: 预留空间，使用骨架屏
- **离屏渲染**: 复杂动画使用Canvas或WebGL

## 8. 模拟数据设计

### 8.1 车辆基础数据

- **车辆数量**: 10-20辆电动车
- **车型分布**: 包括不同品牌和型号
- **注册时间**: 分布在过去1-12个月内

### 8.2 行驶数据生成

- **行驶模式**: 模拟不同时段的行驶模式
- **能耗变化**: 考虑天气、路况等因素影响
- **异常数据**: 5%左右的异常数据点

### 8.3 碳减排数据

- **计算周期**: 每日汇总一次
- **历史数据**: 至少3个月的历史数据
- **趋势特征**: 包含周期性和增长趋势

### 8.4 区块链数据

- **区块生成**: 约10-30秒一个区块
- **交易类型**: 数据上链、碳积分生成等类型
- **合约调用**: 模拟不同合约的调用过程

## 9. 接口对接

### 9.1 API接口规范

- **基础URL**: `/api/v1`
- **响应格式**: JSON
- **状态码**: 标准HTTP状态码
- **错误处理**: 统一错误响应格式

### 9.2 接口设计

详见API接口文档，主要包括:

- 车辆管理接口
- 数据分析接口
- 区块链交互接口

### 9.3 Mock服务

- 使用MSW(Mock Service Worker)模拟API响应
- 提供可配置的延迟和错误率
- 支持模拟各种边缘情况

## 10. 部署与构建

### 10.1 开发环境

- **本地开发**: Vite开发服务器
- **代码规范**: ESLint + Prettier
- **版本控制**: Git + GitHub

### 10.2 构建流程

- **构建工具**: Vite
- **构建优化**: 代码分割、树摇、压缩
- **环境配置**: 开发/测试/生产环境变量

### 10.3 部署方案

- **静态部署**: 构建后的静态文件部署到Web服务器
- **容器化**: 可选Docker容器部署
- **CI/CD**: 自动化构建和部署流程
